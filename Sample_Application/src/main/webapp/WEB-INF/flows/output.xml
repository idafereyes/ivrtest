<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/webflow
        				http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd" 
    start-state="testOutput">
 	
 	<action-state id="testOutput">
		<on-entry>
			<evaluate expression="output" result="flowScope.testOutput"/>

			<!-- Se setean los atributos -->
			<!-- <set name="flowScope.testOutput.bargein" value="true"/> -->
			<set name="flowScope.testOutput.flush" value="true"/>
			<set name="flowScope.testOutput.catchHangup" value="true"/>
			
			<!-- Se setea la lista de locuciones -->
			<!-- Locución pregrabada con TTS de backup. -->
			<evaluate expression="audioItem" result="flowScope.audioItem1" />
			<set name="flowScope.audioItem1.src" value="'SAN-WELCOME-A'" />
			<set name="flowScope.audioItem1.wording" value="'Hello'" />		
			<evaluate expression="flowScope.testOutput.addAudioItem(audioItem1)"/>
			
			<!-- Locución TTS -->
			<evaluate expression="audioItem" result="flowScope.audioItem2" />
			<set name="flowScope.audioItem2.wording" value="'Santander User'" />		
			<evaluate expression="flowScope.testOutput.addAudioItem(audioItem2)"/>

			<!-- Locución TTS con contenido dinámico -->
			<!--<evaluate expression="audioItem" result="flowScope.audioItem2" />
			 <set name="flowScope.audioItem2.wording" value="user" />	
			 <evaluate expression="flowScope.testOutput.addAudioItem(audioItem2)"/> -->

			<!-- Locución pregraba sin TTS de backup -->
			<evaluate expression="audioItem" result="flowScope.audioItem3" />
			<set name="flowScope.audioItem3.src" value="'SAN-WELCOME-C'" />
			<evaluate expression="flowScope.testOutput.addAudioItem(audioItem3)"/>
			<!-- <evaluate expression="flowScope.testOutput.addAudioItem('SAN-WELCOME-C','')"/>-->
			
			<!-- Locución con condición Java -->
			<!-- TODO ver si hay otra manera de expresar la condición -->
			<!-- <evaluate expression="(user == 'idafe')?flowScope.testOutput.addAudioItem('SAN-WELCOME-PREFERENT','for preferent users'):false"/> -->
		</on-entry>

       	<evaluate expression="flowProcessor.process(flowScope.testOutput)"/>
    		
    	<transition to="render" />
    </action-state>
    
    <view-state id="render" view="render"/>
   
</flow>