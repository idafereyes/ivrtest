<var name="attempts" expr="0" />
<var name="noInputAttempt" expr="0" />
<var name="noMatchAttempt" expr="0" />
<var name="maxNoMatch" expr="3" />
<var name="maxNoInput" expr="3" />
<var name="maxInt" expr="4" />
<var name="recAvailable" expr="'DTMF'" />
<var name="returnCode" expr="''" />
<field name="INITIAL_MENU" >
<property name="bargein" value="true" />
<grammar mode="dtmf" type="application/srgs" src="grammars/dtmf/digits?length=1.bnf"/>
<prompt cond="noMatchAttempt == 1 &amp;&amp; returnCode == 'NOMATCH'">
No le he entendido.</prompt>
<prompt cond="noMatchAttempt == 2 &amp;&amp; returnCode == 'NOMATCH'">
Intente hablar mas claro. No le he entendido.</prompt>
<prompt cond="returnCode == 'NOINPUT'">
No le he oido.</prompt>
<prompt>
Por favor, digame su DNI.</prompt>
<catch event="nomatch" >
<assign name="noMatchAttempt" expr="noMatchAttempt + 1" />
<assign name="attempts" expr="noMatchAttempt + noInputAttempt" />
<assign name="returnCode" expr="'NOMATCH'" />
<if cond="noMatchAttempt == maxNoMatch" >
<var name="_eventId" expr="'maxnomatch'" />
<var name="interpretation" expr="null" />
<var name="utterance" expr="null" />
<var name="inputmode" expr="null" />
<var name="confidence" expr="null" />
<submit next="http://flowExecutionUrl/" method="post" namelist="_eventId interpretation utterance inputmode confidence" />
</if>
<reprompt />
</catch>
<catch event="noinput" >
<assign name="noInputAttempt" expr="noInputAttempt + 1" />
<assign name="attempts" expr="noMatchAttempt + noInputAttempt" />
<assign name="returnCode" expr="'NOINPUT'" />
<if cond="noInputAttempt == maxNoInput" >
<var name="_eventId" expr="'maxnoinput'" />
<var name="interpretation" expr="null" />
<var name="utterance" expr="null" />
<var name="inputmode" expr="null" />
<var name="confidence" expr="null" />
<submit next="http://flowExecutionUrl/" method="post" namelist="_eventId interpretation utterance inputmode confidence" />
</if>
<reprompt />
</catch>
<catch event="maxint" >
<var name="_eventId" expr="'maxint'" />
<var name="interpretation" expr="null" />
<var name="utterance" expr="null" />
<var name="inputmode" expr="null" />
<var name="confidence" expr="null" />
<submit next="http://flowExecutionUrl/" method="post" namelist="_eventId interpretation utterance inputmode confidence" />
</catch>
<filled>
<var name="_eventId" expr="'match'" />
<var name="interpretation" />
<var name="utterance" expr="application.lastresult$.utterance" />
<var name="inputmode" expr="application.lastresult$.inputmode" />
<var name="confidence" expr="application.lastresult$.confidence" />
<script>
<![CDATA[if(inputmode == 'voice') {interpretation = lastresult$.interpretation.out;} else {interpretation = utterance;}]]>
</script>
<submit next="http://flowExecutionUrl/" method="post" namelist="_eventId interpretation utterance inputmode confidence" />
</filled>
</field>
